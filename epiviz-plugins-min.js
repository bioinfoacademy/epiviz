goog.provide("epiviz.plugins.charts.BlocksTrack");epiviz.plugins.charts.BlocksTrack=function(id,container,properties){epiviz.ui.charts.Track.call(this,id,container,properties);this._initialize()};epiviz.plugins.charts.BlocksTrack.prototype=epiviz.utils.mapCopy(epiviz.ui.charts.Track.prototype);epiviz.plugins.charts.BlocksTrack.constructor=epiviz.plugins.charts.BlocksTrack;epiviz.plugins.charts.BlocksTrack.prototype._initialize=function(){epiviz.ui.charts.Track.prototype._initialize.call(this)};
epiviz.plugins.charts.BlocksTrack.prototype._addStyles=function(){var svgId="#"+this._svgId;var style=sprintf("%s .items { shape-rendering: crispEdges; fill-opacity: 0.6; stroke: #555555; stroke-opacity: 0.5; stroke-width: 1; }\n",svgId)+sprintf("%s .items .selected { stroke: #ffc600; stroke-width: 5; stroke-opacity: 0.7; fill-opacity: 1; }\n",svgId)+sprintf("%s .items .hovered { stroke: #ffc600; stroke-width: 5; stroke-opacity: 0.7; fill-opacity: 1; }\n",svgId);var jSvg=this._container.find("svg");
jSvg.append(sprintf('<style type="text/css">%s</style>',style))};epiviz.plugins.charts.BlocksTrack.prototype.draw=function(range,data,slide,zoom){epiviz.ui.charts.Track.prototype.draw.call(this,range,data,slide,zoom);data=this._lastData;range=this._lastRange;if(!data||!range)return[];return this._drawBlocks(range,data,slide||0,zoom||1)};
epiviz.plugins.charts.BlocksTrack.prototype._drawBlocks=function(range,data,slide,zoom){var Axis=epiviz.ui.charts.Axis;var start=range.start();var end=range.end();var width=this.width();var height=this.height();var margins=this.margins();var measurements=this.measurements();var colors=this.colors();var minBlockDistance=this._customSettingsValues[epiviz.plugins.charts.BlocksTrackType.CustomSettings.MIN_BLOCK_DISTANCE];var xScale=d3.scale.linear().domain([start,end]).range([0,width-margins.sumAxis(Axis.X)]);
var delta=slide*(width-margins.sumAxis(Axis.X))/(end-start);this._clearAxes();this._drawAxes(xScale,null,10,5);var self=this;var blocks=[];var i=0;measurements.foreach(function(m){var series=data.get(m);var seriesBlocks=[];for(var j=0;j<series.size();++j){var cell=series.get(j);if(cell.rowItem.start()>range.end()||cell.rowItem.end()<range.start())continue;var classes=sprintf("item data-series-%s",i);if(minBlockDistance!==null&&seriesBlocks.length>0){var lastBlock=seriesBlocks[seriesBlocks.length-
1];var start=xScale(cell.rowItem.start());var lastEnd=xScale(lastBlock.end);if(start-lastEnd<minBlockDistance){lastBlock.end=Math.max(lastBlock.end,cell.rowItem.end());lastBlock.valueItems[0].push(cell);lastBlock.id=sprintf("b-%s-%s-%s",i,lastBlock.start,lastBlock.end);continue}}seriesBlocks.push(new epiviz.ui.charts.UiObject(sprintf("b-%s-%s-%s",i,cell.rowItem.start(),cell.rowItem.end()),cell.rowItem.start(),cell.rowItem.end(),null,i,[[cell]],[m],classes))}blocks=blocks.concat(seriesBlocks);++i});
var items=this._svg.select(".items");var selected=items.select(".selected");var clipPath=this._svg.select("#clip-"+this._id);if(items.empty()){if(clipPath.empty())this._svg.select("defs").append("clipPath").attr("id","clip-"+this._id).append("rect").attr("class","clip-path-rect");items=this._svg.append("g").attr("class","items").attr("id",this._id+"-gene-content").attr("clip-path","url(#clip-"+this._id+")");selected=items.append("g").attr("class","selected");items.append("g").attr("class","hovered");
selected.append("g").attr("class","hovered")}items.attr("transform","translate("+margins.left()+", "+margins.top()+")");this._svg.select(".clip-path-rect").attr("x",0).attr("y",0).attr("width",width-margins.sumAxis(Axis.X)).attr("height",height-margins.sumAxis(Axis.Y));var selection=items.selectAll(".item").data(blocks,function(b){return b.id});selection.enter().insert("rect",":first-child").attr("class",function(b){return b.cssClasses}).style("fill",function(b){return colors.get(b.seriesIndex)}).attr("x",
function(b){return xScale(b.start)/zoom+delta}).attr("width",function(b){return zoom*(xScale(b.end+1)-xScale(b.start))}).on("mouseout",function(b){self._unhover.notify()}).on("mouseover",function(b){self._hover.notify(b)}).on("click",function(b){self._deselect.notify();self._select.notify(b);d3.event.stopPropagation()});selection.attr("class",function(b){return b.cssClasses}).attr("height",height-margins.sumAxis(Axis.Y)).attr("y",0).transition().duration(500).attr("x",function(b){return xScale(b.start)}).attr("width",
function(b){return xScale(b.end+1)-xScale(b.start)});selection.exit().transition().duration(500).attr("x",function(b){return xScale(b.start)}).remove();return blocks};epiviz.plugins.charts.BlocksTrack.prototype.chartTypeName=function(){return"epiviz.plugins.charts.BlocksTrack"};epiviz.plugins.charts.BlocksTrack.prototype.setColorMap=function(colorMap){this._container.find(".items").remove();epiviz.ui.charts.Chart.prototype.setColorMap.call(this,colorMap)};goog.provide("epiviz.plugins.charts.BlocksTrackType");goog.require("epiviz.ui.charts.Chart");epiviz.plugins.charts.BlocksTrackType=function(config){epiviz.ui.charts.TrackType.call(this,config)};epiviz.plugins.charts.BlocksTrackType.prototype=epiviz.utils.mapCopy(epiviz.ui.charts.TrackType.prototype);epiviz.plugins.charts.BlocksTrackType.constructor=epiviz.plugins.charts.BlocksTrackType;
epiviz.plugins.charts.BlocksTrackType.prototype.createNew=function(id,container,properties){return new epiviz.plugins.charts.BlocksTrack(id,container,properties)};epiviz.plugins.charts.BlocksTrackType.prototype.typeName=function(){return"epiviz.plugins.charts.BlocksTrack"};epiviz.plugins.charts.BlocksTrackType.prototype.chartName=function(){return"Blocks Track"};epiviz.plugins.charts.BlocksTrackType.prototype.chartHtmlAttributeName=function(){return"blocks"};
epiviz.plugins.charts.BlocksTrackType.prototype.chartContentType=function(){return epiviz.measurements.Measurement.Type.RANGE};epiviz.plugins.charts.BlocksTrackType.prototype.customSettingsDefs=function(){return epiviz.ui.charts.TrackType.prototype.customSettingsDefs.call(this).concat([new epiviz.ui.charts.CustomSetting(epiviz.plugins.charts.BlocksTrackType.CustomSettings.MIN_BLOCK_DISTANCE,epiviz.ui.charts.CustomSetting.Type.NUMBER,5,"Minimum block distance")])};
epiviz.plugins.charts.BlocksTrackType.CustomSettings={MIN_BLOCK_DISTANCE:"minBlockDistance"};goog.provide("epiviz.plugins.charts.LineTrack");epiviz.plugins.charts.LineTrack=function(id,container,properties){epiviz.ui.charts.Track.call(this,id,container,properties);this._initialize()};epiviz.plugins.charts.LineTrack.prototype=epiviz.utils.mapCopy(epiviz.ui.charts.Track.prototype);epiviz.plugins.charts.LineTrack.constructor=epiviz.plugins.charts.LineTrack;epiviz.plugins.charts.LineTrack.prototype._initialize=function(){epiviz.ui.charts.Track.prototype._initialize.call(this)};
epiviz.plugins.charts.LineTrack.prototype.draw=function(range,data,slide,zoom){var lastRange=this._lastRange;epiviz.ui.charts.Track.prototype.draw.call(this,range,data,slide,zoom);data=this._lastData;range=this._lastRange;if(lastRange&&range&&lastRange.overlapsWith(range)&&lastRange.width()==range.width())slide=range.start()-lastRange.start();if(!data||!range)return[];var CustomSetting=epiviz.ui.charts.CustomSetting;var minY=this._customSettingsValues[epiviz.ui.charts.ChartType.CustomSettings.Y_MIN];
var maxY=this._customSettingsValues[epiviz.ui.charts.ChartType.CustomSettings.Y_MAX];if(minY==CustomSetting.DEFAULT){minY=null;this.measurements().foreach(function(m){if(m===null)return;if(minY===null||m.minValue()<minY)minY=m.minValue()})}if(maxY==CustomSetting.DEFAULT){maxY=null;this.measurements().foreach(function(m){if(m===null)return;if(maxY===null||m.maxValue()>maxY)maxY=m.maxValue()})}if(minY===null&&maxY===null){minY=-1;maxY=1}if(minY===null)minY=maxY-1;if(maxY===null)maxY=minY+1;var Axis=
epiviz.ui.charts.Axis;var xScale=d3.scale.linear().domain([range.start(),range.end()]).range([0,this.width()-this.margins().sumAxis(Axis.X)]);var yScale=d3.scale.linear().domain([minY,maxY]).range([this.height()-this.margins().sumAxis(Axis.Y),0]);this._clearAxes();this._drawAxes(xScale,yScale,10,5);slide=slide||0;var delta=slide*(this.width()-this.margins().sumAxis(Axis.X))/range.width();var linesGroup=this._svg.selectAll(".lines");if(linesGroup.empty()){var graph=this._svg.append("g").attr("class",
"lines").attr("transform","translate("+this.margins().left()+", "+this.margins().top()+")");this.measurements().foreach(function(m,i){graph.append("g").attr("class","line-series-index-"+i);graph.append("g").attr("class","point-series-index-"+i)})}return this._drawLines(range,data,delta,zoom||1,xScale,yScale)};
epiviz.plugins.charts.LineTrack.prototype._drawLines=function(range,data,delta,zoom,xScale,yScale){var margins=this.margins();var colors=this.colors();var maxPoints=this._customSettingsValues[epiviz.plugins.charts.LineTrackType.CustomSettings.MAX_POINTS];var showPoints=this._customSettingsValues[epiviz.plugins.charts.LineTrackType.CustomSettings.SHOW_POINTS];var showLines=this._customSettingsValues[epiviz.plugins.charts.LineTrackType.CustomSettings.SHOW_LINES];var pointRadius=this._customSettingsValues[epiviz.plugins.charts.LineTrackType.CustomSettings.POINT_RADIUS];
var lineThickness=this._customSettingsValues[epiviz.plugins.charts.LineTrackType.CustomSettings.LINE_THICKNESS];var interpolation=this._customSettingsValues[epiviz.plugins.charts.LineTrackType.CustomSettings.INTERPOLATION];var self=this;var invXScale=d3.scale.linear().domain([0,this.width()-this.margins().sumAxis(epiviz.ui.charts.Axis.X)]).range([range.start(),range.end()]);var deltaInBp=invXScale(delta)-range.start();var extendedRange=epiviz.datatypes.GenomicRange.fromStartEnd(range.seqName(),Math.min(range.start(),
range.start()+deltaInBp),Math.max(range.end(),range.end()+deltaInBp));var graph=this._svg.select(".lines");var items=[];this.measurements().foreach(function(m,i){var series=data.get(m);var drawBoundaries=series.binarySearchStarts(extendedRange);if(drawBoundaries.length==0)return;if(drawBoundaries.index>0){--drawBoundaries.index;++drawBoundaries.length}if(drawBoundaries.index+drawBoundaries.length<series.size())++drawBoundaries.length;var indices=null;if(maxPoints===null||drawBoundaries.length<=maxPoints)indices=
epiviz.utils.range(drawBoundaries.length,drawBoundaries.index);else{var step=drawBoundaries.length/maxPoints;indices=[];for(var j=0;Math.round(j)<drawBoundaries.length;j+=step)indices.push(drawBoundaries.index+Math.round(j))}for(var k=0;k<indices.length;++k){var cell=series.get(indices[k]);items.push(new epiviz.ui.charts.UiObject(sprintf("line_%s_%s",i,cell.globalIndex),cell.rowItem.start(),cell.rowItem.end(),[cell.value],i,[[cell]],[m],sprintf("item data-series-%s",i)))}var x=function(j){var cell=
series.get(j);return xScale(cell.rowItem.start())};var y=function(j){var cell=series.get(j);return yScale(cell.value)};if(showLines){var line=d3.svg.line().x(x).y(y).interpolate(interpolation);var lines=graph.select(".line-series-index-"+i).selectAll("path").data([indices]);lines.enter().append("path").attr("d",line).style("shape-rendering","auto").style("stroke-opacity","0.7").on("mouseover",function(){self._captureMouseHover()}).on("mousemove",function(){self._captureMouseHover()}).on("mouseout",
function(){self._unhover.notify()});lines.attr("d",line).style("stroke",colors.get(i)).style("stroke-width",lineThickness).attr("transform","translate("+ +delta+")").transition().duration(500).attr("transform","translate("+0+")")}else graph.select(".line-series-index-"+i).selectAll("path").remove();graph.select(".point-series-index-"+i).selectAll("circle").remove();if(showPoints){var points=graph.select(".point-series-index-"+i).selectAll("circle").data(indices);points.enter().append("circle").attr("class",
"point-series-index-"+i).attr("r",pointRadius).attr("cx",x).attr("cy",y).attr("fill","none").attr("stroke",colors.get(i)).attr("transform","translate("+ +delta+")").transition().duration(500).attr("transform","translate("+0+")");points.on("mouseover",function(){self._captureMouseHover()}).on("mousemove",function(){self._captureMouseHover()}).on("mouseout",function(){self._unhover.notify()});points.exit().transition().duration(500).style("opacity",0).remove()}});return items};
epiviz.plugins.charts.LineTrack.prototype.chartTypeName=function(){return"epiviz.plugins.charts.LineTrack"};goog.provide("epiviz.plugins.charts.LineTrackType");goog.require("epiviz.ui.charts.Chart");epiviz.plugins.charts.LineTrackType=function(config){epiviz.ui.charts.TrackType.call(this,config)};epiviz.plugins.charts.LineTrackType.prototype=epiviz.utils.mapCopy(epiviz.ui.charts.TrackType.prototype);epiviz.plugins.charts.LineTrackType.constructor=epiviz.plugins.charts.LineTrackType;
epiviz.plugins.charts.LineTrackType.prototype.createNew=function(id,container,properties){return new epiviz.plugins.charts.LineTrack(id,container,properties)};epiviz.plugins.charts.LineTrackType.prototype.typeName=function(){return"epiviz.plugins.charts.LineTrack"};epiviz.plugins.charts.LineTrackType.prototype.chartName=function(){return"Line Track"};epiviz.plugins.charts.LineTrackType.prototype.chartHtmlAttributeName=function(){return"lines"};
epiviz.plugins.charts.LineTrackType.prototype.chartContentType=function(){return epiviz.measurements.Measurement.Type.FEATURE};
epiviz.plugins.charts.LineTrackType.prototype.customSettingsDefs=function(){return epiviz.ui.charts.TrackType.prototype.customSettingsDefs.call(this).concat([new epiviz.ui.charts.CustomSetting(epiviz.plugins.charts.LineTrackType.CustomSettings.MAX_POINTS,epiviz.ui.charts.CustomSetting.Type.NUMBER,100,"Maximum points"),new epiviz.ui.charts.CustomSetting(epiviz.plugins.charts.LineTrackType.CustomSettings.SHOW_POINTS,epiviz.ui.charts.CustomSetting.Type.BOOLEAN,false,"Show points"),new epiviz.ui.charts.CustomSetting(epiviz.plugins.charts.LineTrackType.CustomSettings.SHOW_LINES,
epiviz.ui.charts.CustomSetting.Type.BOOLEAN,true,"Show lines"),new epiviz.ui.charts.CustomSetting(epiviz.plugins.charts.LineTrackType.CustomSettings.POINT_RADIUS,epiviz.ui.charts.CustomSetting.Type.NUMBER,1,"Point radius"),new epiviz.ui.charts.CustomSetting(epiviz.plugins.charts.LineTrackType.CustomSettings.LINE_THICKNESS,epiviz.ui.charts.CustomSetting.Type.NUMBER,1,"Line thickness"),new epiviz.ui.charts.CustomSetting(epiviz.ui.charts.ChartType.CustomSettings.Y_MIN,epiviz.ui.charts.CustomSetting.Type.NUMBER,
epiviz.ui.charts.CustomSetting.DEFAULT,"Min Y"),new epiviz.ui.charts.CustomSetting(epiviz.ui.charts.ChartType.CustomSettings.Y_MAX,epiviz.ui.charts.CustomSetting.Type.NUMBER,epiviz.ui.charts.CustomSetting.DEFAULT,"Max Y"),new epiviz.ui.charts.CustomSetting(epiviz.plugins.charts.LineTrackType.CustomSettings.INTERPOLATION,epiviz.ui.charts.CustomSetting.Type.CATEGORICAL,"linear","Interpolation",["linear","step-before","step-after","basis","basis-open","basis-closed","bundle","cardinal","cardinal-open",
"monotone"])])};epiviz.plugins.charts.LineTrackType.CustomSettings={MAX_POINTS:"maxPoints",SHOW_POINTS:"showPoints",SHOW_LINES:"showLines",POINT_RADIUS:"pointRadius",LINE_THICKNESS:"lineThickness",INTERPOLATION:"interpolation"};goog.provide("epiviz.plugins.charts.GenesTrack");epiviz.plugins.charts.GenesTrack=function(id,container,properties){epiviz.ui.charts.Track.call(this,id,container,properties);this._initialize()};epiviz.plugins.charts.GenesTrack.prototype=epiviz.utils.mapCopy(epiviz.ui.charts.Track.prototype);epiviz.plugins.charts.GenesTrack.constructor=epiviz.plugins.charts.GenesTrack;epiviz.plugins.charts.GenesTrack.prototype._initialize=function(){epiviz.ui.charts.Track.prototype._initialize.call(this)};
epiviz.plugins.charts.GenesTrack.prototype._addStyles=function(){var svgId="#"+this._svgId;var style=sprintf("%s .items { shape-rendering: auto; /* fill: %s; */ stroke: #555555; fill-opacity: 0.6; }\n",svgId,this.colors().get(0))+sprintf("%s .exons { /* fill: %s; */ stroke: none; }\n",svgId,this.colors().get(1))+sprintf("%s .gene-name { font-weight: bold; font-size: 12; fill: #000000; stroke: none; fill-opacity: 0; }\n",svgId)+sprintf("%s .selected { /*filter: url(#%s-dropshadow);*/ fill-opacity: 1; stroke: #555555; }\n",
svgId,this._id)+sprintf("%s .selected .gene-body { /* fill: #ffc600; */ stroke: %s; stroke-width: 3; stroke-opacity: 0.7; }\n",svgId,this.colors().get(1))+sprintf("%s .hovered { /*filter: url(#%s-dropshadow);*/ fill-opacity: 1; stroke: #555555; }\n",svgId,this._id)+sprintf("%s .hovered .gene-body { /* fill: #ffc600; */ stroke: %s; stroke-width: 3; stroke-opacity: 0.7; }\n",svgId,this.colors().get(1))+sprintf("%s .hovered .gene-name { fill-opacity: 1; }\n",svgId)+sprintf("%s .selected .gene-name { fill-opacity: 1; }\n",
svgId);var jSvg=this._container.find("svg");jSvg.append(sprintf('<style type="text/css">%s</style>',style))};
epiviz.plugins.charts.GenesTrack.prototype.draw=function(range,data,slide,zoom){var lastRange=this._lastRange;epiviz.ui.charts.Track.prototype.draw.call(this,range,data,slide,zoom);data=this._lastData;range=this._lastRange;if(lastRange&&range&&lastRange.overlapsWith(range)&&lastRange.width()==range.width())slide=range.start()-lastRange.start();if(lastRange&&range&&lastRange.overlapsWith(range)&&lastRange.width()!=range.width())zoom=lastRange.width()/range.width();if(!data||!range)return[];return this._drawGenes(range,
data,slide||0,zoom||1)};
epiviz.plugins.charts.GenesTrack.prototype._drawGenes=function(range,data,slide,zoom){var Axis=epiviz.ui.charts.Axis;var start=range.start();var end=range.end();var width=this.width();var height=this.height();var margins=this.margins();var measurements=this.measurements();var colors=this.colors();var xScale=d3.scale.linear().domain([start,end]).range([0,width-margins.sumAxis(Axis.X)]);var delta=slide*(width-margins.sumAxis(Axis.X))/(end-start);this._clearAxes();this._drawAxes(xScale,null,10,5);var self=
this;var series=data.first().value;var indices=epiviz.utils.range(series.size());var dataItems=indices.map(function(i){var cell=series.get(i);var item=cell.rowItem;var classes=sprintf("item gene-%s",item.metadata("gene"));return new epiviz.ui.charts.UiObject(item.metadata("gene"),item.start(),item.end(),null,0,[[cell]],[series.measurement()],classes)});if(zoom){this._svg.select(".items").remove();this._svg.select("defs").select("#clip-"+this._id).remove()}var items=this._svg.select(".items");var selected=
items.select(".selected");if(items.empty()){var defs=this._svg.select("defs");defs.append("clipPath").attr("id","clip-"+this._id).append("rect").attr("x",0).attr("y",0).attr("width",width-margins.sumAxis(Axis.X)).attr("height",height-margins.sumAxis(Axis.Y));items=this._svg.append("g").attr("class","items").attr("transform","translate("+margins.left()+", "+margins.top()+")").attr("id",this._id+"-gene-content").attr("clip-path","url(#clip-"+this._id+")");selected=items.append("g").attr("class","selected");
items.append("g").attr("class","hovered");selected.append("g").attr("class","hovered")}var selection=items.selectAll(".item").data(dataItems,function(d){return d.id});selection.enter().insert("g",":first-child").on("mouseout",function(d){self._unhover.notify()}).on("mouseover",function(d){self._hover.notify(d)}).on("click",function(d){self._deselect.notify();self._select.notify(d);d3.event.stopPropagation()}).attr("transform","translate("+delta+", 0) scale(1, 1)").each(function(d){self._drawGene(this,
d,xScale)});if(delta)selection.each(function(d){self._translateGene(this,d,delta)});selection.exit().transition().duration(500).style("opacity",0).remove();return dataItems};
epiviz.plugins.charts.GenesTrack.prototype._translateGene=function(elem,d,delta){var gene=d3.select(elem);var transform=gene.attr("transform");var translateRx=new RegExp("translate\\([\\d\\.\\-]+[\\,\\s]+[\\d\\.\\-]+\\)","g");var numberRx=new RegExp("[\\d\\.\\-]+","g");var translate=transform.match(translateRx)[0];var x=parseFloat(translate.match(numberRx)[0]);transform=transform.replace(translateRx,"translate("+(x-delta)+", 0)");gene.transition().duration(500).attr("transform",transform)};
epiviz.plugins.charts.GenesTrack.prototype._drawGene=function(elem,d,xScale){var Axis=epiviz.ui.charts.Axis;var self=this;var rowItem=d.valueItems[0][0].rowItem;var geneStart=xScale(d.start);var geneEnd=xScale(d.end);var or=rowItem.strand()=="+"?1:-1;var offset=-or*(this.height()-this.margins().sumAxis(Axis.Y))*.25;var exonStarts=rowItem.metadata("exon_starts").split(",").map(function(s){return parseInt(s)});var exonEnds=rowItem.metadata("exon_ends").split(",").map(function(s){return parseInt(s)});
var exonCount=exonStarts.length;var exonIndices=d3.range(0,exonCount);var geneHeight=this.height()*.08;var exonHeight=this.height()*.16;var h=geneHeight*Math.sqrt(3)*.5;var gene=d3.select(elem);gene.attr("class",d.cssClasses);gene.append("polygon").attr("class","gene-body").style("fill",this.colors().get(0)).attr("points",function(){var xs=null,ys=null;var y0=(self.height()-self.margins().sumAxis(Axis.Y)-geneHeight)*.5+offset;ys=[y0,y0,y0+geneHeight*.5,y0+geneHeight,y0+geneHeight];if(rowItem.strand()==
"+")xs=[geneStart,geneEnd,geneEnd+h,geneEnd,geneStart];else xs=[geneEnd,geneStart,geneStart-h,geneStart,geneEnd];return sprintf("%s,%s %s,%s %s,%s %s,%s %s,%s",xs[0],ys[0],xs[1],ys[1],xs[2],ys[2],xs[3],ys[3],xs[4],ys[4])});var exons=gene.append("g").attr("class","exons").style("fill",this.colors().get(1));exons.selectAll("rect").data(exonIndices).enter().append("rect").attr("x",function(j){return xScale(exonStarts[j])}).attr("y",(self.height()-exonHeight-self.margins().sumAxis(Axis.Y))*.5+offset).attr("width",
function(j){return xScale(exonEnds[j])-xScale(exonStarts[j])}).attr("height",exonHeight);gene.append("text").attr("class","gene-name").attr("x",geneStart+2).attr("y",(self.height()-self.margins().sumAxis(Axis.Y))*.5+offset-or*(geneHeight+2)).style("dominant-baseline","central").text(d.id)};epiviz.plugins.charts.GenesTrack.prototype.chartTypeName=function(){return"epiviz.plugins.charts.GenesTrack"};
epiviz.plugins.charts.GenesTrack.prototype.colorMap=function(){return[{name:"Genes",color:this._properties.colors.get(0)},{name:"Exons",color:this._properties.colors.get(1)}]};
epiviz.plugins.charts.GenesTrack.prototype._drawAxes=function(xScale,yScale,xTicks,yTicks,svg,width,height,margins){epiviz.ui.charts.Track.prototype._drawAxes.call(this,xScale,yScale,xTicks,yTicks,svg,width,height,margins);var Axis=epiviz.ui.charts.Axis;var axesGroup=this._svg.select(".axes");axesGroup.append("g").attr("class","xAxis").append("line").attr("x1",this.margins().left()).attr("x2",this.width()-this.margins().left()).attr("y1",this.margins().top()+(this.height()-this.margins().sumAxis(Axis.Y))*
.5).attr("y2",this.margins().top()+(this.height()-this.margins().sumAxis(Axis.Y))*.5).style("stroke","#555555").style("shape-rendering","crispEdges")};goog.provide("epiviz.plugins.charts.GenesTrackType");goog.require("epiviz.ui.charts.Chart");epiviz.plugins.charts.GenesTrackType=function(config){epiviz.ui.charts.TrackType.call(this,config)};epiviz.plugins.charts.GenesTrackType.prototype=epiviz.utils.mapCopy(epiviz.ui.charts.TrackType.prototype);epiviz.plugins.charts.GenesTrackType.constructor=epiviz.plugins.charts.GenesTrackType;
epiviz.plugins.charts.GenesTrackType.prototype.createNew=function(id,container,properties){return new epiviz.plugins.charts.GenesTrack(id,container,properties)};epiviz.plugins.charts.GenesTrackType.prototype.typeName=function(){return"epiviz.plugins.charts.GenesTrack"};epiviz.plugins.charts.GenesTrackType.prototype.chartName=function(){return"Genes Track"};epiviz.plugins.charts.GenesTrackType.prototype.chartHtmlAttributeName=function(){return"genes"};
epiviz.plugins.charts.GenesTrackType.prototype.chartContentType=function(){return epiviz.measurements.Measurement.Type.RANGE};goog.provide("epiviz.plugins.charts.HeatmapPlot");epiviz.plugins.charts.HeatmapPlot=function(id,container,properties){epiviz.ui.charts.Plot.call(this,id,container,properties);this._chartContent=null;this._jChartContent=null;this._min=this.measurements().first().minValue();this._max=this.measurements().first().maxValue();this._colorScale=epiviz.utils.colorizeBinary(this._min,this._max,this.colors().get(0),this.colors().get(1));this._initialize()};epiviz.plugins.charts.HeatmapPlot.prototype=epiviz.utils.mapCopy(epiviz.ui.charts.Plot.prototype);
epiviz.plugins.charts.HeatmapPlot.constructor=epiviz.plugins.charts.HeatmapPlot;epiviz.plugins.charts.HeatmapPlot.prototype._initialize=function(){epiviz.ui.charts.Plot.prototype._initialize.call(this);this._chartContent=this._svg.append("g").attr("class","chart-content");this._jChartContent=this._container.find(".chart-content")};
epiviz.plugins.charts.HeatmapPlot.prototype._addStyles=function(){var svgId="#"+this._svgId;var style=sprintf("%s .items { stroke: #efefef; stroke-opacity: 0.3; shape-rendering: 'crispEdges'; }\n",svgId)+sprintf("%s .selected .item { stroke: #ffc600; stroke-width: 2; stroke-opacity: 1.0; fill-opacity: 1; }\n",svgId)+sprintf("%s .hovered .item { stroke: #ffc600; stroke-width: 2; stroke-opacity: 1.0; fill-opacity: 1; }\n",svgId)+sprintf("%s .col-text { text-anchor: start; font-size: 10px; }\n",svgId)+
sprintf("%s .row-text { text-anchor: end; font-size: 9px; }\n",svgId)+sprintf("%s .selected .col-text { font-weight: bold; fill-opacity: 1; font-size: 10px; }\n",svgId)+sprintf("%s .hovered .col-text { font-weight: bold; fill-opacity: 1; font-size: 10px; }\n",svgId)+sprintf("%s .selected .row-text { font-weight: bold; fill-opacity: 1; font-size: 10px; }\n",svgId)+sprintf("%s .hovered .row-text { font-weight: bold; fill-opacity: 1; font-size: 10px; }\n",svgId);var jSvg=this._container.find("svg");
jSvg.append(sprintf('<style type="text/css">%s</style>',style))};epiviz.plugins.charts.HeatmapPlot.prototype.draw=function(range,data){epiviz.ui.charts.Plot.prototype.draw.call(this,range,data);data=this._lastData;range=this._lastRange;if(!data||!range)return[];return this._drawCells(range,data)};
epiviz.plugins.charts.HeatmapPlot.prototype._drawCells=function(range,data){var self=this;var Axis=epiviz.ui.charts.Axis;var maxColumns=this._customSettingsValues[epiviz.plugins.charts.HeatmapPlotType.CustomSettings.MAX_COLUMNS];var firstGlobalIndex=data.first().value.globalStartIndex();var lastGlobalIndex=data.first().value.size()+firstGlobalIndex;var rownames=[];data.foreach(function(measurement,series){var firstIndex=series.globalStartIndex();var lastIndex=series.size()+firstIndex;if(firstIndex>
firstGlobalIndex)firstGlobalIndex=firstIndex;if(lastIndex<lastGlobalIndex)lastGlobalIndex=lastIndex;rownames.push(measurement.name())});var nEntries=lastGlobalIndex-firstGlobalIndex;var label=this._customSettingsValues[epiviz.ui.charts.ChartType.CustomSettings.LABEL];var width=this.width();var height=this.height();var colnames=[],columnMap={};var i,globalIndex;for(i=0;i<nEntries;++i){globalIndex=i+firstGlobalIndex;var item=data.get(this.measurements().first()).getByGlobalIndex(globalIndex).rowItem;
if(item.start()<range.end()&&item.end()>range.start()){var colLabel=item.metadata(label)||""+item.id();columnMap[colnames.length]=globalIndex;colnames.push(colLabel)}}var items=[];var colIndex={};this.measurements().foreach(function(m,seriesIndex){var nextCellsPerCol=Math.ceil(colnames.length/maxColumns),cellsPerCol=0;var colsLeft=maxColumns;for(var i=0;i<colnames.length;++i){globalIndex=columnMap[i];var cell=data.get(m).getByGlobalIndex(globalIndex);var uiObj=null;if(cellsPerCol==0){var classes=
sprintf("item data-series-%s",seriesIndex);uiObj=new epiviz.ui.charts.UiObject(sprintf("heatmap_%s_%s",seriesIndex,globalIndex),cell.rowItem.start(),cell.rowItem.end(),[cell.value],seriesIndex,[[cell]],[m],classes);items.push(uiObj);nextCellsPerCol=Math.ceil((colnames.length-i)/colsLeft);cellsPerCol=nextCellsPerCol;--colsLeft}else{uiObj=items[items.length-1];uiObj.id+="_"+globalIndex;uiObj.start=Math.min(uiObj.start,cell.rowItem.start());uiObj.end=Math.max(uiObj.end,cell.rowItem.end());uiObj.values[0]=
(uiObj.values[0]*uiObj.valueItems[0].length+cell.value)/(uiObj.valueItems[0].length+1);uiObj.valueItems[0].push(cell)}if(seriesIndex==0)colIndex[globalIndex]=items.length-1;--cellsPerCol}});var nCols=Math.min(colnames.length,maxColumns);var cellWidth=nCols?(this.width()-this.margins().sumAxis(Axis.X))/nCols:0;var cellHeight=(this.height()-this.margins().sumAxis(Axis.Y))/this.measurements().size();this._colorScale=epiviz.utils.colorizeBinary(this._min,this._max,this.colors().get(0),this.colors().get(1));
var itemsGroup=this._chartContent.select(".items");if(itemsGroup.empty()){itemsGroup=this._chartContent.append("g").attr("class","items");var selectedGroup=itemsGroup.append("g").attr("class","selected");itemsGroup.append("g").attr("class","hovered");selectedGroup.append("g").attr("class","hovered")}itemsGroup.attr("transform","translate("+this.margins().left()+", "+this.margins().top()+")");var selection=itemsGroup.selectAll("rect").data(items,function(d){return d.id});selection.enter().append("rect").attr("id",
function(d){return sprintf("%s-item-%s-%s",self._id,d.seriesIndex,d.valueItems[0][0].globalIndex)}).attr("class",function(d){return d.cssClasses}).style("opacity",0).style("fill-opacity",0).attr("x",function(d,i){return cellWidth*colIndex[d.valueItems[0][0].globalIndex]}).attr("y",function(d){return cellHeight*d.seriesIndex}).attr("width",cellWidth).attr("height",cellHeight).style("fill",function(d){return self._colorScale(d.values[0])});selection.transition().duration(1E3).style("fill-opacity",null).style("opacity",
null).attr("x",function(d,i){return cellWidth*colIndex[d.valueItems[0][0].globalIndex]}).attr("y",function(d){return cellHeight*d.seriesIndex}).attr("width",cellWidth).attr("height",cellHeight).style("fill",function(d){return self._colorScale(d.values[0])});selection.exit().transition().duration(1E3).style("opacity",0).remove();selection.on("mouseover",function(d){self._hover.notify(d)}).on("mouseout",function(d){self._unhover.notify()}).on("click",function(d){self._deselect.notify();self._select.notify(d);
d3.event.stopPropagation()});var mapCol=function(i,centered){return i*cellWidth+(centered?.5*cellWidth:0)};var mapRow=function(i,centered){return i*cellHeight+(centered?cellHeight*.5:0)};var colSelection=itemsGroup.selectAll(".col-text");if(colnames.length>nCols)colSelection.transition().duration(500).style("opacity",0).remove();else{colSelection=colSelection.data(colnames,function(d,i){return d+columnMap[i]});colSelection.enter().append("text").attr("class","col-text").style("opacity","0").attr("x",
0).attr("y",0).attr("transform",function(d,i){return"translate("+mapCol(i,true)+","+-5+")rotate(-60)"}).text(function(d){return d});colSelection.transition().duration(500).attr("x",0).attr("y",0).attr("transform",function(d,i){return"translate("+mapCol(i,true)+","+-5+")rotate(-60)"}).style("opacity",null);colSelection.exit().transition().duration(500).style("opacity",0).remove()}var rowSelection=itemsGroup.selectAll(".row-text").data(rownames,String);rowSelection.enter().append("text").attr("class",
function(d){return"row-text"}).attr("x",0).attr("y",0).attr("transform",function(d,i){return"translate("+-5+","+mapRow(i,true)+")rotate(30)"}).text(function(d){return d});rowSelection.transition().duration(500).attr("x",0).attr("y",0).attr("transform",function(d,i){return"translate("+-5+","+mapRow(i,true)+")rotate(30)"});return items};epiviz.plugins.charts.HeatmapPlot.prototype.chartTypeName=function(){return"epiviz.plugins.charts.HeatmapPlot"};
epiviz.plugins.charts.HeatmapPlot.prototype.colorMap=function(){return[{name:"Min",color:this.colors().get(0)},{name:"Max",color:this.colors().get(1)}]};goog.provide("epiviz.plugins.charts.HeatmapPlotType");goog.require("epiviz.ui.charts.Chart");epiviz.plugins.charts.HeatmapPlotType=function(config){epiviz.ui.charts.PlotType.call(this,config)};epiviz.plugins.charts.HeatmapPlotType.prototype=epiviz.utils.mapCopy(epiviz.ui.charts.PlotType.prototype);epiviz.plugins.charts.HeatmapPlotType.constructor=epiviz.plugins.charts.HeatmapPlotType;
epiviz.plugins.charts.HeatmapPlotType.prototype.createNew=function(id,container,properties){return new epiviz.plugins.charts.HeatmapPlot(id,container,properties)};epiviz.plugins.charts.HeatmapPlotType.prototype.typeName=function(){return"epiviz.plugins.charts.HeatmapPlot"};epiviz.plugins.charts.HeatmapPlotType.prototype.chartName=function(){return"Heatmap"};epiviz.plugins.charts.HeatmapPlotType.prototype.chartHtmlAttributeName=function(){return"heatmap"};
epiviz.plugins.charts.HeatmapPlotType.prototype.chartContentType=function(){return epiviz.measurements.Measurement.Type.FEATURE};epiviz.plugins.charts.HeatmapPlotType.prototype.isRestrictedToSameDatasourceGroup=function(){return true};
epiviz.plugins.charts.HeatmapPlotType.prototype.customSettingsDefs=function(){return epiviz.ui.charts.PlotType.prototype.customSettingsDefs.call(this).concat([new epiviz.ui.charts.CustomSetting(epiviz.ui.charts.ChartType.CustomSettings.LABEL,epiviz.ui.charts.CustomSetting.Type.STRING,"probe","Columns labels"),new epiviz.ui.charts.CustomSetting(epiviz.plugins.charts.HeatmapPlotType.CustomSettings.MAX_COLUMNS,epiviz.ui.charts.CustomSetting.Type.NUMBER,40,"Max columns")])};
epiviz.plugins.charts.HeatmapPlotType.CustomSettings={MAX_COLUMNS:"maxColumns"};goog.provide("epiviz.plugins.charts.ScatterPlot");
epiviz.plugins.charts.ScatterPlot=function(id,container,properties){epiviz.ui.charts.Plot.call(this,id,container,properties);this._chartContent=null;this._jChartContent=null;this._legend=null;this._measurementsX=[];this._measurementsY=[];var self=this;this.measurements().foreach(function(m,i){if(i%2==0)self._measurementsX.push(m);else self._measurementsY.push(m)});this._xLabel="";this._yLabel="";for(var i=0;i<Math.min(this._measurementsX.length,this._measurementsY.length);++i){if(i>0){this._xLabel+=
", ";this._yLabel+=", "}this._xLabel+=this._measurementsX[i].name();this._yLabel+=this._measurementsY[i].name()}this._initialize()};epiviz.plugins.charts.ScatterPlot.prototype=epiviz.utils.mapCopy(epiviz.ui.charts.Plot.prototype);epiviz.plugins.charts.ScatterPlot.constructor=epiviz.plugins.charts.ScatterPlot;
epiviz.plugins.charts.ScatterPlot.prototype._initialize=function(){epiviz.ui.charts.Plot.prototype._initialize.call(this);this._chartContent=this._svg.append("g").attr("class","chart-content");this._jChartContent=this._container.find(".chart-content");this._legend=this._svg.append("g").attr("class","chart-legend")};
epiviz.plugins.charts.ScatterPlot.prototype._addStyles=function(){var svgId="#"+this._svgId;var style=sprintf("%s .items {}\n",svgId)+sprintf("%s .items .selected { fill: #1a6d00; stroke: #ffc600; stroke-width: 2; stroke-opacity: 1.0; opacity: 1; }\n",svgId)+sprintf("%s .items .hovered { fill: #1a6d00; stroke: #ffc600; stroke-width: 2; stroke-opacity: 1.0; opacity: 1; }\n",svgId);var nSeries=Math.min(this._measurementsX.length,this._measurementsY.length);for(var i=0;i<nSeries;++i)style+=sprintf("%s .data-series-%s { opacity: 1.0; }\n",
svgId,i);var jSvg=this._container.find("svg");jSvg.append(sprintf('<style type="text/css">%s</style>',style))};epiviz.plugins.charts.ScatterPlot.prototype.draw=function(range,data){epiviz.ui.charts.Plot.prototype.draw.call(this,range,data);data=this._lastData;range=this._lastRange;if(!data||!range)return[];return this._drawCircles(range,data)};
epiviz.plugins.charts.ScatterPlot.prototype._drawCircles=function(range,data){var self=this;var Axis=epiviz.ui.charts.Axis;var circleRadius=Math.max(1,this._customSettingsValues[epiviz.plugins.charts.ScatterPlotType.CustomSettings.CIRCLE_RADIUS_RATIO]*Math.min(this.width(),this.height()));var gridSquareSize=Math.max(Math.floor(circleRadius),1);var nSeries=Math.min(this._measurementsX.length,this._measurementsY.length);var firstGlobalIndex=data.first().value.globalStartIndex();var lastGlobalIndex=
data.first().value.size()+firstGlobalIndex;data.foreach(function(measurement,series){var firstIndex=series.globalStartIndex();var lastIndex=series.size()+firstIndex;if(firstIndex>firstGlobalIndex)firstGlobalIndex=firstIndex;if(lastIndex<lastGlobalIndex)lastGlobalIndex=lastIndex});var nGenes=lastGlobalIndex-firstGlobalIndex;var margins=this.margins();var width=this.width();var height=this.height();var CustomSetting=epiviz.ui.charts.CustomSetting;var minY=this._customSettingsValues[epiviz.ui.charts.ChartType.CustomSettings.Y_MIN];
var maxY=this._customSettingsValues[epiviz.ui.charts.ChartType.CustomSettings.Y_MAX];var minX=this._customSettingsValues[epiviz.ui.charts.ChartType.CustomSettings.X_MIN];var maxX=this._customSettingsValues[epiviz.ui.charts.ChartType.CustomSettings.X_MAX];if(minX==CustomSetting.DEFAULT)minX=this._measurementsX[0].minValue();if(minY==CustomSetting.DEFAULT)minY=this._measurementsY[0].minValue();if(maxX==CustomSetting.DEFAULT)maxX=this._measurementsX[0].maxValue();if(maxY==CustomSetting.DEFAULT)maxY=
this._measurementsY[0].maxValue();var xScale=d3.scale.linear().domain([minX,maxX]).range([0,width-margins.sumAxis(Axis.X)]);var yScale=d3.scale.linear().domain([minY,maxY]).range([height-margins.sumAxis(Axis.Y),0]);this._clearAxes(this._chartContent);this._drawAxes(xScale,yScale,15,15,this._chartContent);var i,index;var indices=[];for(i=0;i<nGenes;++i){index=i+firstGlobalIndex;var item=data.get(this._measurementsX[0]).getByGlobalIndex(index).rowItem;if(item.start()<range.end()&&item.end()>range.start())for(var j=
0;j<nSeries;++j)indices.push(j*nGenes+i)}var grid={};var items=[];var maxGroupItems=1;for(i=0;i<indices.length;++i){index=indices[i]%nGenes;var globalIndex=index+firstGlobalIndex;var seriesIndex=Math.floor(index/nGenes);var mX=self._measurementsX[seriesIndex];var mY=self._measurementsY[seriesIndex];var cellX=data.get(mX).getByGlobalIndex(globalIndex);var cellY=data.get(mY).getByGlobalIndex(globalIndex);var classes=sprintf("item data-series-%s",seriesIndex);var x=xScale(cellX.value);var y=yScale(cellY.value);
var gridX=Math.floor(x/gridSquareSize)*gridSquareSize;var gridY=Math.floor(y/gridSquareSize)*gridSquareSize;var uiObj=null;if(grid[gridY]&&grid[gridY][gridX]){uiObj=grid[gridY][gridX];uiObj.id+="_"+cellX.globalIndex;uiObj.start=Math.min(uiObj.start,cellX.rowItem.start());uiObj.end=Math.max(uiObj.end,cellX.rowItem.end());uiObj.values[0]=(uiObj.values[0]*uiObj.valueItems[0].length+cellX.value)/(uiObj.valueItems[0].length+1);uiObj.values[1]=(uiObj.values[1]*uiObj.valueItems[1].length+cellY.value)/(uiObj.valueItems[1].length+
1);uiObj.valueItems[0].push(cellX);uiObj.valueItems[1].push(cellY);if(uiObj.valueItems[0].length>maxGroupItems)maxGroupItems=uiObj.valueItems[0].length;continue}uiObj=new epiviz.ui.charts.UiObject(sprintf("scatter_%s_%s",seriesIndex,cellX.globalIndex),cellX.rowItem.start(),cellX.rowItem.end(),[cellX.value,cellY.value],seriesIndex,[[cellX],[cellY]],[mX,mY],classes);if(!grid[gridY])grid[gridY]={};grid[gridY][gridX]=uiObj;items.push(uiObj)}var itemsGroup=this._chartContent.select(".items");if(itemsGroup.empty()){itemsGroup=
this._chartContent.append("g").attr("class","items");var selectedGroup=itemsGroup.append("g").attr("class","selected");itemsGroup.append("g").attr("class","hovered");selectedGroup.append("g").attr("class","hovered")}var selection=itemsGroup.selectAll("circle").data(items,function(d){return d.id});selection.enter().insert("circle",":first-child").attr("id",function(d){return sprintf("%s-item-%s-%s",self._id,d.seriesIndex,d.valueItems[0][0].globalIndex)}).style("opacity",0).style("fill-opacity",0).attr("r",
0);selection.each(function(d){var circle=d3.select(this);circle.attr("cx",margins.left()+(d.values[0]-minX)*(width-margins.sumAxis(Axis.X))/(maxX-minX)).attr("cy",height-margins.bottom()-(d.values[1]-minY)*(height-margins.sumAxis(Axis.Y))/(maxY-minY)).attr("class",d.cssClasses).style("fill",self.colors().get(d.seriesIndex))});selection.transition().duration(1E3).style("fill-opacity",function(d){return Math.max(.3,d.valueItems[0].length/maxGroupItems)}).style("opacity",null).attr("r",circleRadius);
selection.exit().transition().duration(1E3).style("opacity",0).attr("r",0).remove();selection.on("mouseover",function(d){self._hover.notify(d)}).on("mouseout",function(d){self._unhover.notify()}).on("click",function(d){self._deselect.notify();self._select.notify(d);d3.event.stopPropagation()});return items};epiviz.plugins.charts.ScatterPlot.prototype.chartTypeName=function(){return"epiviz.plugins.charts.ScatterPlot"};
epiviz.plugins.charts.ScatterPlot.prototype.colorMap=function(){var self=this;var n=Math.min(this._measurementsX.length,this._measurementsY.length);var colors=new Array(n);for(var i=0;i<n;++i)colors[i]={name:sprintf("%s vs %s",this._measurementsX[i].name(),this._measurementsY[i].name()),color:this._properties.colors.get(i)};return colors};
epiviz.plugins.charts.ScatterPlot.prototype._drawAxes=function(xScale,yScale,xTicks,yTicks,svg,width,height,margins){epiviz.ui.charts.Plot.prototype._drawAxes.call(this,xScale,yScale,xTicks,yTicks,svg,width,height,margins);this._legend.selectAll("text").remove();var xWidth=this._xLabel.length*7;var yWidth=this._yLabel.length*7;this._legend.append("text").attr("x",(this.width()-xWidth)*.5).attr("y",this.height()-this.margins().bottom()+35).attr("style","font-weight: regular; font-size: 12;").attr("fill",
"#000000").attr("stroke","none").style("fill-opacity",1).text(this._xLabel);this._legend.append("text").attr("x",-this.height()+(this.height()-yWidth)*.5+this.margins().top()).attr("y",this.margins().left()-25).attr("transform","rotate(-90)").attr("style","font-weight: regular; font-size: 12;").attr("fill","#000000").attr("stroke","none").style("fill-opacity",1).text(this._yLabel)};goog.provide("epiviz.plugins.charts.ScatterPlotType");goog.require("epiviz.ui.charts.Chart");epiviz.plugins.charts.ScatterPlotType=function(config){epiviz.ui.charts.PlotType.call(this,config)};epiviz.plugins.charts.ScatterPlotType.prototype=epiviz.utils.mapCopy(epiviz.ui.charts.PlotType.prototype);epiviz.plugins.charts.ScatterPlotType.constructor=epiviz.plugins.charts.ScatterPlotType;
epiviz.plugins.charts.ScatterPlotType.prototype.createNew=function(id,container,properties){return new epiviz.plugins.charts.ScatterPlot(id,container,properties)};epiviz.plugins.charts.ScatterPlotType.prototype.typeName=function(){return"epiviz.plugins.charts.ScatterPlot"};epiviz.plugins.charts.ScatterPlotType.prototype.chartName=function(){return"Scatter Plot"};epiviz.plugins.charts.ScatterPlotType.prototype.chartHtmlAttributeName=function(){return"scatter"};
epiviz.plugins.charts.ScatterPlotType.prototype.chartContentType=function(){return epiviz.measurements.Measurement.Type.FEATURE};epiviz.plugins.charts.ScatterPlotType.prototype.isRestrictedToSameDatasourceGroup=function(){return true};epiviz.plugins.charts.ScatterPlotType.prototype.minSelectedMeasurements=function(){return 2};
epiviz.plugins.charts.ScatterPlotType.prototype.customSettingsDefs=function(){return epiviz.ui.charts.PlotType.prototype.customSettingsDefs.call(this).concat([new epiviz.ui.charts.CustomSetting(epiviz.plugins.charts.ScatterPlotType.CustomSettings.CIRCLE_RADIUS_RATIO,epiviz.ui.charts.CustomSetting.Type.NUMBER,.015,"Circle radius ratio"),new epiviz.ui.charts.CustomSetting(epiviz.ui.charts.ChartType.CustomSettings.X_MIN,epiviz.ui.charts.CustomSetting.Type.NUMBER,epiviz.ui.charts.CustomSetting.DEFAULT,
"Min X"),new epiviz.ui.charts.CustomSetting(epiviz.ui.charts.ChartType.CustomSettings.X_MAX,epiviz.ui.charts.CustomSetting.Type.NUMBER,epiviz.ui.charts.CustomSetting.DEFAULT,"Max X"),new epiviz.ui.charts.CustomSetting(epiviz.ui.charts.ChartType.CustomSettings.Y_MIN,epiviz.ui.charts.CustomSetting.Type.NUMBER,epiviz.ui.charts.CustomSetting.DEFAULT,"Min Y"),new epiviz.ui.charts.CustomSetting(epiviz.ui.charts.ChartType.CustomSettings.Y_MAX,epiviz.ui.charts.CustomSetting.Type.NUMBER,epiviz.ui.charts.CustomSetting.DEFAULT,
"Max Y")])};epiviz.plugins.charts.ScatterPlotType.CustomSettings={CIRCLE_RADIUS_RATIO:"circleRadiusRatio"};